# Deploy TikMatrix & YTMatrix (main branch)
name: Deploy TikMatrix & YTMatrix
run-name: ${{ github.actor }} is deploying TikMatrix & YTMatrix ðŸš€

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  build:
    uses: ./.github/workflows/build-reusable.yml
    with:
      artifact-name: tikmatrix
      run-brand-replace: false

  deploy-tikmatrix-1:
    needs: build
    uses: ./.github/workflows/deploy-reusable.yml
    with:
      artifact-name: tikmatrix
      target-dir: /var/www.tikmatrix.com
    secrets:
      SERVER_HOST: ${{ secrets.SERVER_HOST }}
      SERVER_USER: ${{ secrets.SERVER_USER }}
      SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
      SERVER_PORT: ${{ secrets.SERVER_PORT }}

  deploy-tikmatrix-2:
    needs: build
    uses: ./.github/workflows/deploy-reusable.yml
    with:
      artifact-name: tikmatrix
      target-dir: /var/www.tikmatrix.com
    secrets:
      SERVER_HOST: ${{ secrets.SERVER_HOST_2 }}
      SERVER_USER: ${{ secrets.SERVER_USER }}
      SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
      SERVER_PORT: ${{ secrets.SERVER_PORT }}

  deploy-ytmatrix:
    needs: build
    uses: ./.github/workflows/deploy-reusable.yml
    with:
      artifact-name: tikmatrix
      target-dir: /var/www.ytmatrix.com
    secrets:
      SERVER_HOST: ${{ secrets.SERVER_HOST }}
      SERVER_USER: ${{ secrets.SERVER_USER }}
      SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
      SERVER_PORT: ${{ secrets.SERVER_PORT }}
